2025-03-17 12:18:40,625 - __main__ - INFO - === Starting intent merger training ===
2025-03-17 12:18:40,625 - __main__ - INFO - Parsing command line arguments...
2025-03-17 12:18:40,628 - __main__ - INFO - Arguments: Namespace(config='config.json', generate_only=False, enrich=False, augment=True, output='training/generated_training_data.json', model_output='models/intent_classifier_merged', early_stopping=True, epochs=40, batch_size=32, vocab_size=10000, embedding_dim=150, max_sequence_length=50, patience=8, validation_split=0.2, min_per_class=50, max_per_class=800, merge_classes=True, augmentation_factor=0.3, use_existing_data=True, debug=False)
2025-03-17 12:18:40,628 - __main__ - INFO - Preparing training data...
2025-03-17 12:18:40,637 - __main__ - INFO - Loading existing training data from training/generated_training_data.json
2025-03-17 12:18:40,639 - __main__ - INFO - Loaded 6679 examples from existing file
2025-03-17 12:18:40,639 - __main__ - INFO - Proceeding to model training...
2025-03-17 12:18:40,642 - __main__ - INFO - Starting model training process...
2025-03-17 12:18:40,647 - __main__ - INFO - Merged 16 intent classes into 12 classes
2025-03-17 12:18:40,647 - __main__ - INFO - Original classes: ['database_query_comparative_highest', 'database_query_comparative_lowest', 'database_query_comparative_middle', 'database_query_count', 'database_query_detailed', 'database_query_filter', 'database_query_list', 'database_query_recent', 'database_query_sensitive', 'database_query_sort', 'database_query_sort_ascending', 'database_query_sort_descending', 'database_query_specific_id', 'goodbye', 'greeting', 'help']
2025-03-17 12:18:40,647 - __main__ - INFO - Merged classes: ['database_query_comparative', 'database_query_count', 'database_query_detailed', 'database_query_filter', 'database_query_list', 'database_query_recent', 'database_query_sensitive', 'database_query_sort', 'database_query_specific_id', 'goodbye', 'greeting', 'help']
2025-03-17 12:18:40,650 - __main__ - INFO - Merged class counts: {'database_query_list': 360, 'database_query_detailed': 160, 'database_query_count': 321, 'database_query_sort': 2147, 'database_query_comparative': 1890, 'database_query_recent': 109, 'database_query_specific_id': 121, 'database_query_filter': 1524, 'database_query_sensitive': 7, 'greeting': 13, 'help': 13, 'goodbye': 14}
2025-03-17 12:18:40,651 - __main__ - INFO - Class database_query_sensitive: Duplicated from 7 to 56 examples
2025-03-17 12:18:40,651 - __main__ - INFO - Class greeting: Duplicated from 13 to 52 examples
2025-03-17 12:18:40,651 - __main__ - INFO - Class help: Duplicated from 13 to 52 examples
2025-03-17 12:18:40,651 - __main__ - INFO - Class goodbye: Duplicated from 14 to 56 examples
2025-03-17 12:18:40,653 - __main__ - INFO - After balancing: 5287 total examples
2025-03-17 12:18:40,653 - __main__ - INFO - Final class distribution: {'database_query_comparative': 1600, 'database_query_filter': 800, 'database_query_list': 360, 'database_query_count': 321, 'database_query_sort': 1600, 'help': 52, 'database_query_specific_id': 121, 'goodbye': 56, 'database_query_recent': 109, 'database_query_detailed': 160, 'database_query_sensitive': 56, 'greeting': 52}
2025-03-17 12:18:40,657 - __main__ - INFO - Original class distribution: {'database_query_comparative': 1600, 'database_query_filter': 800, 'database_query_list': 360, 'database_query_count': 321, 'database_query_sort': 1600, 'help': 52, 'database_query_specific_id': 121, 'goodbye': 56, 'database_query_recent': 109, 'database_query_detailed': 160, 'database_query_sensitive': 56, 'greeting': 52}
2025-03-17 12:18:40,659 - __main__ - INFO - Applying enhanced augmentation for database_query_comparative with 1600 examples
2025-03-17 12:18:40,676 - __main__ - INFO - Applying enhanced augmentation for database_query_sort with 1600 examples
2025-03-17 12:18:40,724 - __main__ - INFO - Created 4887 additional examples for database_query_comparative
2025-03-17 12:18:40,735 - __main__ - INFO - Created 3459 additional examples for database_query_sort
2025-03-17 12:18:40,737 - __main__ - INFO - After augmentation: 21340 examples
2025-03-17 12:18:40,737 - __main__ - INFO - Final class distribution: {'database_query_comparative': 10273, 'database_query_filter': 893, 'database_query_list': 454, 'database_query_count': 338, 'database_query_sort': 8899, 'help': 13, 'database_query_specific_id': 121, 'goodbye': 14, 'database_query_recent': 132, 'database_query_detailed': 179, 'database_query_sensitive': 11, 'greeting': 13}
2025-03-17 12:18:40,737 - __main__ - INFO - Tokenizing and preparing sequences...
2025-03-17 12:18:41,053 - __main__ - INFO - Training with 12 intent classes: ['database_query_comparative', 'database_query_count', 'database_query_detailed', 'database_query_filter', 'database_query_list', 'database_query_recent', 'database_query_sensitive', 'database_query_sort', 'database_query_specific_id', 'goodbye', 'greeting', 'help']
2025-03-17 12:18:41,053 - __main__ - INFO - Will save model to models/intent_classifier_merged
2025-03-17 12:18:42,153 - __main__ - INFO - Model architecture:
2025-03-17 12:18:42,153 - __main__ - INFO - Model: "model"
2025-03-17 12:18:42,154 - __main__ - INFO - __________________________________________________________________________________________________
2025-03-17 12:18:42,154 - __main__ - INFO -  Layer (type)                   Output Shape         Param #     Connected to                     
2025-03-17 12:18:42,154 - __main__ - INFO - ==================================================================================================
2025-03-17 12:18:42,154 - __main__ - INFO -  input_1 (InputLayer)           [(None, 50)]         0           []                               
2025-03-17 12:18:42,154 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,154 - __main__ - INFO -  embedding (Embedding)          (None, 50, 150)      1500000     ['input_1[0][0]']                
2025-03-17 12:18:42,154 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,154 - __main__ - INFO -  conv1d (Conv1D)                (None, 50, 128)      57728       ['embedding[0][0]']              
2025-03-17 12:18:42,154 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,154 - __main__ - INFO -  conv1d_1 (Conv1D)              (None, 50, 128)      76928       ['embedding[0][0]']              
2025-03-17 12:18:42,154 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,154 - __main__ - INFO -  conv1d_2 (Conv1D)              (None, 50, 128)      96128       ['embedding[0][0]']              
2025-03-17 12:18:42,154 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,154 - __main__ - INFO -  global_max_pooling1d (GlobalMa  (None, 128)         0           ['conv1d[0][0]']                 
2025-03-17 12:18:42,154 - __main__ - INFO -  xPooling1D)                                                                                      
2025-03-17 12:18:42,158 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,158 - __main__ - INFO -  global_max_pooling1d_1 (Global  (None, 128)         0           ['conv1d_1[0][0]']               
2025-03-17 12:18:42,158 - __main__ - INFO -  MaxPooling1D)                                                                                    
2025-03-17 12:18:42,158 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,158 - __main__ - INFO -  global_max_pooling1d_2 (Global  (None, 128)         0           ['conv1d_2[0][0]']               
2025-03-17 12:18:42,158 - __main__ - INFO -  MaxPooling1D)                                                                                    
2025-03-17 12:18:42,158 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,158 - __main__ - INFO -  concatenate (Concatenate)      (None, 384)          0           ['global_max_pooling1d[0][0]',   
2025-03-17 12:18:42,158 - __main__ - INFO -                                                                   'global_max_pooling1d_1[0][0]', 
2025-03-17 12:18:42,158 - __main__ - INFO -                                                                   'global_max_pooling1d_2[0][0]'] 
2025-03-17 12:18:42,158 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,158 - __main__ - INFO -  dropout (Dropout)              (None, 384)          0           ['concatenate[0][0]']            
2025-03-17 12:18:42,158 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,158 - __main__ - INFO -  dense (Dense)                  (None, 256)          98560       ['dropout[0][0]']                
2025-03-17 12:18:42,158 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,158 - __main__ - INFO -  dropout_1 (Dropout)            (None, 256)          0           ['dense[0][0]']                  
2025-03-17 12:18:42,158 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,158 - __main__ - INFO -  dense_1 (Dense)                (None, 12)           3084        ['dropout_1[0][0]']              
2025-03-17 12:18:42,158 - __main__ - INFO -                                                                                                   
2025-03-17 12:18:42,158 - __main__ - INFO - ==================================================================================================
2025-03-17 12:18:42,161 - __main__ - INFO - Total params: 1,832,428
2025-03-17 12:18:42,161 - __main__ - INFO - Trainable params: 1,832,428
2025-03-17 12:18:42,161 - __main__ - INFO - Non-trainable params: 0
2025-03-17 12:18:42,161 - __main__ - INFO - __________________________________________________________________________________________________
2025-03-17 12:18:42,161 - __main__ - INFO - Added early stopping with patience=8
2025-03-17 12:18:42,161 - __main__ - INFO - Starting training with 40 epochs...
2025-03-17 12:20:12,357 - __main__ - INFO - Validation accuracy progression: [0.7999062538146973, 0.8008434772491455, 0.8214620351791382, 0.845829427242279, 0.8006091713905334, 0.8385660648345947, 0.8327085375785828, 0.8608247637748718, 0.8648078441619873, 0.8683223724365234, 0.8720712065696716, 0.8680881261825562, 0.8659793734550476, 0.8608247637748718, 0.8603561520576477, 0.8608247637748718, 0.8601218461990356, 0.8631677627563477, 0.8605904579162598]
2025-03-17 12:20:12,357 - __main__ - INFO - Best validation accuracy: 0.8720712065696716
2025-03-17 12:20:12,357 - __main__ - INFO - Training complete. Saving model to models/intent_classifier_merged
2025-03-17 12:20:12,416 - model.intent_classifier - INFO - Model saved to models/intent_classifier_merged\model.h5
2025-03-17 12:20:12,424 - model.intent_classifier - INFO - Tokenizer saved to models/intent_classifier_merged\tokenizer.json
2025-03-17 12:20:12,425 - model.intent_classifier - INFO - Intent classes saved to models/intent_classifier_merged\intent_classes.json
2025-03-17 12:20:12,427 - model.intent_classifier - INFO - Model configuration saved to models/intent_classifier_merged\model_config.json
2025-03-17 12:20:12,427 - __main__ - INFO - Model saved successfully
2025-03-17 12:20:12,472 - __main__ - INFO - Additional model file saved to models/intent_classifier_merged\model.h5
2025-03-17 12:20:12,472 - __main__ - INFO - Intent mappings saved to models/intent_classifier_merged\intent_mappings.json
2025-03-17 12:20:12,472 - __main__ - INFO - Model training completed successfully
2025-03-17 12:20:12,472 - __main__ - INFO - === Training completed successfully ===
2025-03-17 15:06:43,699 - encryption_manager - INFO - Homomorphic encryption context initialized
2025-03-17 15:06:43,699 - __main__ - WARNING - Model not found at models/intent_classifier. Using uninitialized classifier.
2025-03-17 15:06:43,699 - model.chatbot_engine - INFO - Intent merger initialized
2025-03-17 15:06:43,699 - speech.speech_recognition - INFO - Secure speech recognition module initialized
2025-03-17 15:06:43,699 - __main__ - INFO - Speech recognition initialized successfully
2025-03-17 15:06:43,702 - __main__ - INFO - All components initialized successfully
2025-03-17 15:06:45,769 - database_connector - INFO - Connected to MySQL database: fm_database
2025-03-17 15:06:45,769 - __main__ - INFO - Initializing speech recognition routes
2025-03-17 15:06:45,772 - __main__ - INFO - Training API routes added successfully
2025-03-17 15:06:45,772 - api.flask_api - INFO - Starting server on 0.0.0.0:5000
2025-03-17 15:06:45,798 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.162:5000
2025-03-17 15:06:45,798 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-03-17 15:06:45,801 - werkzeug - INFO -  * Restarting with stat
2025-03-17 15:06:52,453 - encryption_manager - INFO - Homomorphic encryption context initialized
2025-03-17 15:06:52,454 - __main__ - WARNING - Model not found at models/intent_classifier. Using uninitialized classifier.
2025-03-17 15:06:52,454 - model.chatbot_engine - INFO - Intent merger initialized
2025-03-17 15:06:52,454 - speech.speech_recognition - INFO - Secure speech recognition module initialized
2025-03-17 15:06:52,454 - __main__ - INFO - Speech recognition initialized successfully
2025-03-17 15:06:52,458 - __main__ - INFO - All components initialized successfully
2025-03-17 15:06:54,496 - database_connector - INFO - Connected to MySQL database: fm_database
2025-03-17 15:06:54,496 - __main__ - INFO - Initializing speech recognition routes
2025-03-17 15:06:54,496 - __main__ - INFO - Training API routes added successfully
2025-03-17 15:06:54,496 - api.flask_api - INFO - Starting server on 0.0.0.0:5000
2025-03-17 15:06:54,510 - werkzeug - WARNING -  * Debugger is active!
2025-03-17 15:06:54,518 - werkzeug - INFO -  * Debugger PIN: 103-700-790
2025-03-17 15:06:54,555 - werkzeug - INFO - 127.0.0.1 - - [17/Mar/2025 15:06:54] "GET / HTTP/1.1" 200 -
2025-03-17 15:06:54,746 - werkzeug - INFO - 127.0.0.1 - - [17/Mar/2025 15:06:54] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-03-17 15:06:54,761 - werkzeug - INFO - 127.0.0.1 - - [17/Mar/2025 15:06:54] "[36mGET /static/js/script.js HTTP/1.1[0m" 304 -
2025-03-17 15:06:54,761 - werkzeug - INFO - 127.0.0.1 - - [17/Mar/2025 15:06:54] "[36mGET /static/js/speech.js HTTP/1.1[0m" 304 -
2025-03-17 15:07:00,095 - model.intent_classifier - ERROR - Model or tokenizer not initialized
2025-03-17 15:07:00,095 - model.chatbot_engine - INFO - Classified intent: {'intent': 'database_query_list', 'confidence': 0.5}
2025-03-17 15:07:00,095 - query_processor - INFO - Direct query processing for: Show me all details about markets
2025-03-17 15:07:00,097 - query_processor - INFO - Generated SQL from natural language: SELECT markets.name, markets.location FROM markets LIMIT 100
2025-03-17 15:07:00,100 - werkzeug - INFO - 127.0.0.1 - - [17/Mar/2025 15:07:00] "POST /api/chat HTTP/1.1" 200 -
2025-03-17 15:07:16,438 - model.intent_classifier - ERROR - Model or tokenizer not initialized
2025-03-17 15:07:16,438 - model.chatbot_engine - INFO - Classified intent: {'intent': 'database_query_list', 'confidence': 0.5}
2025-03-17 15:07:16,438 - query_processor - INFO - Direct query processing for: show me all Traders
2025-03-17 15:07:16,438 - query_processor - INFO - Generated SQL from natural language: SELECT traders.name, traders.registration_date FROM traders LIMIT 100
2025-03-17 15:07:16,443 - werkzeug - INFO - 127.0.0.1 - - [17/Mar/2025 15:07:16] "POST /api/chat HTTP/1.1" 200 -
2025-03-17 15:08:07,908 - model.intent_classifier - ERROR - Model or tokenizer not initialized
2025-03-17 15:08:07,910 - model.chatbot_engine - INFO - Classified intent: {'intent': 'database_query_list', 'confidence': 0.5}
2025-03-17 15:08:07,910 - query_processor - INFO - Direct query processing for: Find traders with lowest transaction count
2025-03-17 15:08:07,910 - query_processor - INFO - Generated SQL from natural language: SELECT traders.name, traders.registration_date FROM traders, transactions LIMIT 100
2025-03-17 15:08:07,916 - werkzeug - INFO - 127.0.0.1 - - [17/Mar/2025 15:08:07] "POST /api/chat HTTP/1.1" 200 -
